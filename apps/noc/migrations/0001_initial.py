# Generated by Django 5.2.7 on 2025-11-09 10:20

import apps.peoples.models.base_model
import django.contrib.postgres.fields
import django.core.validators
import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = []

    operations = [
        migrations.CreateModel(
            name="AlertCluster",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "cluster_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                        verbose_name="Cluster ID",
                    ),
                ),
                (
                    "cluster_signature",
                    models.CharField(
                        db_index=True,
                        help_text="ML-generated signature for cluster identification",
                        max_length=200,
                        verbose_name="Cluster Signature",
                    ),
                ),
                (
                    "cluster_confidence",
                    models.FloatField(
                        default=0.0,
                        help_text="0-1.0 confidence score for cluster quality",
                        verbose_name="Cluster Confidence",
                    ),
                ),
                (
                    "cluster_method",
                    models.CharField(
                        choices=[
                            ("cosine_similarity", "Cosine Similarity"),
                            ("xgboost_similarity", "XGBoost Similarity"),
                            ("manual", "Manual Grouping"),
                        ],
                        default="cosine_similarity",
                        max_length=50,
                        verbose_name="Clustering Method",
                    ),
                ),
                (
                    "feature_vector",
                    models.JSONField(
                        default=dict,
                        help_text="Clustering features used for similarity calculation",
                        verbose_name="Feature Vector",
                    ),
                ),
                (
                    "combined_severity",
                    models.CharField(
                        choices=[
                            ("INFO", "Informational"),
                            ("LOW", "Low"),
                            ("MEDIUM", "Medium"),
                            ("HIGH", "High"),
                            ("CRITICAL", "Critical"),
                        ],
                        help_text="Maximum severity from all alerts in cluster",
                        max_length=20,
                        verbose_name="Combined Severity",
                    ),
                ),
                (
                    "affected_sites",
                    models.JSONField(
                        default=list,
                        help_text="List of site IDs affected by this cluster",
                        verbose_name="Affected Sites",
                    ),
                ),
                (
                    "affected_people",
                    models.JSONField(
                        default=list,
                        help_text="List of person IDs affected by this cluster",
                        verbose_name="Affected People",
                    ),
                ),
                (
                    "alert_types_in_cluster",
                    models.JSONField(
                        default=list,
                        help_text="List of alert types present in this cluster",
                        verbose_name="Alert Types",
                    ),
                ),
                (
                    "first_alert_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="Timestamp of first alert in cluster",
                        verbose_name="First Alert Time",
                    ),
                ),
                (
                    "last_alert_at",
                    models.DateTimeField(
                        help_text="Timestamp of most recent alert in cluster",
                        verbose_name="Last Alert Time",
                    ),
                ),
                (
                    "alert_count",
                    models.IntegerField(
                        default=1,
                        help_text="Total number of alerts in cluster",
                        verbose_name="Alert Count",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True,
                        default=True,
                        help_text="Whether cluster is still accepting new alerts",
                        verbose_name="Is Active",
                    ),
                ),
                (
                    "suppressed_alert_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of alerts auto-suppressed (similarity >0.9)",
                        verbose_name="Suppressed Alert Count",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Alert Cluster",
                "verbose_name_plural": "NOC Alert Clusters",
                "db_table": "noc_alert_cluster",
                "ordering": ["-last_alert_at"],
            },
        ),
        migrations.CreateModel(
            name="CorrelatedIncident",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "incident_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique incident identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "signals",
                    models.JSONField(
                        default=dict,
                        help_text="Collected activity signals (phone events, location, tasks, tours)",
                    ),
                ),
                (
                    "combined_severity",
                    models.CharField(
                        choices=[
                            ("CRITICAL", "Critical"),
                            ("HIGH", "High"),
                            ("MEDIUM", "Medium"),
                            ("LOW", "Low"),
                            ("INFO", "Info"),
                        ],
                        db_index=True,
                        default="INFO",
                        help_text="Combined severity calculated from signals and alerts",
                        max_length=20,
                    ),
                ),
                (
                    "correlation_window_minutes",
                    models.IntegerField(
                        default=15,
                        help_text="Time window used for correlation (Â±minutes)",
                    ),
                ),
                (
                    "correlation_score",
                    models.FloatField(
                        default=0.0, help_text="Correlation confidence score (0.0-1.0)"
                    ),
                ),
                (
                    "correlation_type",
                    models.CharField(
                        default="TIME_ENTITY",
                        help_text="Type of correlation applied (TIME_ENTITY, PATTERN, etc.)",
                        max_length=50,
                    ),
                ),
                (
                    "detected_at",
                    models.DateTimeField(
                        auto_now_add=True,
                        db_index=True,
                        help_text="When correlation was detected",
                    ),
                ),
                (
                    "investigated",
                    models.BooleanField(
                        default=False,
                        help_text="Whether incident has been investigated",
                    ),
                ),
                (
                    "investigated_at",
                    models.DateTimeField(
                        blank=True, help_text="When investigated", null=True
                    ),
                ),
                (
                    "investigation_notes",
                    models.TextField(blank=True, help_text="Investigation findings"),
                ),
                (
                    "root_cause_identified",
                    models.BooleanField(
                        default=False,
                        help_text="Whether root cause has been identified",
                    ),
                ),
                (
                    "root_cause_description",
                    models.TextField(
                        blank=True, help_text="Description of identified root cause"
                    ),
                ),
            ],
            options={
                "verbose_name": "Correlated Incident",
                "verbose_name_plural": "Correlated Incidents",
                "db_table": "noc_correlated_incident",
                "ordering": ["-detected_at"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="ExecutablePlaybook",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "playbook_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        db_index=True,
                        help_text="Human-readable playbook name",
                        max_length=200,
                    ),
                ),
                (
                    "description",
                    models.TextField(
                        help_text="Detailed description of playbook purpose and actions"
                    ),
                ),
                (
                    "finding_types",
                    models.JSONField(
                        default=list,
                        help_text="List of finding types that trigger this playbook (e.g., ['TOUR_OVERDUE', 'SILENT_SITE'])",
                    ),
                ),
                (
                    "severity_threshold",
                    models.CharField(
                        choices=[
                            ("CRITICAL", "Critical"),
                            ("HIGH", "High"),
                            ("MEDIUM", "Medium"),
                            ("LOW", "Low"),
                        ],
                        default="MEDIUM",
                        help_text="Minimum severity level to trigger playbook",
                        max_length=20,
                    ),
                ),
                (
                    "auto_execute",
                    models.BooleanField(
                        db_index=True,
                        default=False,
                        help_text="If True, playbook executes automatically. If False, requires manual approval.",
                    ),
                ),
                (
                    "actions",
                    models.JSONField(
                        default=list,
                        help_text="Ordered list of actions: [{type, params, timeout, critical}, ...]",
                    ),
                ),
                (
                    "total_executions",
                    models.IntegerField(
                        default=0,
                        help_text="Total number of times playbook has been executed",
                    ),
                ),
                (
                    "successful_executions",
                    models.IntegerField(
                        default=0,
                        help_text="Number of successful executions (all actions passed)",
                    ),
                ),
                (
                    "failed_executions",
                    models.IntegerField(
                        default=0, help_text="Number of failed executions"
                    ),
                ),
                (
                    "avg_execution_time_seconds",
                    models.FloatField(
                        default=0.0, help_text="Average execution time in seconds"
                    ),
                ),
                (
                    "success_rate",
                    models.FloatField(
                        default=0.0,
                        help_text="Success rate (successful_executions / total_executions)",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True,
                        default=True,
                        help_text="If False, playbook will not be triggered",
                    ),
                ),
            ],
            options={
                "verbose_name": "Executable Playbook",
                "verbose_name_plural": "Executable Playbooks",
                "db_table": "noc_executable_playbook",
                "ordering": ["-cdtz"],
            },
        ),
        migrations.CreateModel(
            name="IncidentContext",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "context_data",
                    models.JSONField(
                        help_text="Enriched context with 5 categories",
                        verbose_name="Context Data",
                    ),
                ),
                (
                    "enriched_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Enriched At"),
                ),
                (
                    "cache_expires_at",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When this cached context expires",
                        verbose_name="Cache Expires At",
                    ),
                ),
                (
                    "related_alerts_count",
                    models.IntegerField(default=0, verbose_name="Related Alerts Count"),
                ),
                (
                    "recent_changes_count",
                    models.IntegerField(default=0, verbose_name="Recent Changes Count"),
                ),
                (
                    "historical_incidents_count",
                    models.IntegerField(
                        default=0, verbose_name="Historical Incidents Count"
                    ),
                ),
                (
                    "affected_sites_count",
                    models.IntegerField(default=0, verbose_name="Affected Sites Count"),
                ),
                (
                    "affected_people_count",
                    models.IntegerField(
                        default=0, verbose_name="Affected People Count"
                    ),
                ),
            ],
            options={
                "verbose_name": "Incident Context",
                "verbose_name_plural": "Incident Contexts",
                "db_table": "noc_incident_context",
                "ordering": ["-enriched_at"],
            },
        ),
        migrations.CreateModel(
            name="MaintenanceWindow",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "title",
                    models.CharField(max_length=200, verbose_name="Maintenance Title"),
                ),
                (
                    "description",
                    models.TextField(blank=True, null=True, verbose_name="Description"),
                ),
                (
                    "start_time",
                    models.DateTimeField(
                        help_text="Maintenance window start time",
                        verbose_name="Start Time",
                    ),
                ),
                (
                    "end_time",
                    models.DateTimeField(
                        help_text="Maintenance window end time", verbose_name="End Time"
                    ),
                ),
                (
                    "suppress_all",
                    models.BooleanField(
                        default=False,
                        help_text="If True, suppress ALL alerts during this window",
                        verbose_name="Suppress All Alerts",
                    ),
                ),
                (
                    "suppress_alerts",
                    models.JSONField(
                        default=list,
                        help_text="List of alert type codes to suppress (e.g., ['DEVICE_OFFLINE', 'SYNC_DEGRADED'])",
                        verbose_name="Suppress Alert Types",
                    ),
                ),
                (
                    "reason",
                    models.TextField(
                        help_text="Reason for maintenance window", verbose_name="Reason"
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        default=True,
                        help_text="Can be deactivated to cancel maintenance",
                        verbose_name="Active",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Maintenance Window",
                "verbose_name_plural": "NOC Maintenance Windows",
                "db_table": "noc_maintenance_window",
                "ordering": ["-start_time"],
            },
        ),
        migrations.CreateModel(
            name="MLModelMetrics",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "model_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique model identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "model_version",
                    models.IntegerField(
                        help_text="Model version number (increments on each training)"
                    ),
                ),
                (
                    "model_type",
                    models.CharField(
                        choices=[
                            ("fraud_detection", "Fraud Detection"),
                            ("anomaly_detection", "Anomaly Detection"),
                            ("risk_prediction", "Risk Prediction"),
                        ],
                        db_index=True,
                        default="fraud_detection",
                        help_text="Type of ML model",
                        max_length=50,
                    ),
                ),
                (
                    "precision",
                    models.FloatField(
                        help_text="Model precision score (0.0-1.0)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "recall",
                    models.FloatField(
                        help_text="Model recall score (0.0-1.0)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "f1_score",
                    models.FloatField(
                        help_text="Model F1 score (0.0-1.0)",
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "accuracy",
                    models.FloatField(
                        blank=True,
                        help_text="Model accuracy score (0.0-1.0)",
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(0.0),
                            django.core.validators.MaxValueValidator(1.0),
                        ],
                    ),
                ),
                (
                    "training_samples",
                    models.IntegerField(
                        help_text="Number of samples used for training"
                    ),
                ),
                (
                    "test_samples",
                    models.IntegerField(
                        blank=True,
                        help_text="Number of samples used for testing",
                        null=True,
                    ),
                ),
                (
                    "fraud_samples",
                    models.IntegerField(
                        blank=True,
                        help_text="Number of fraud samples in training set",
                        null=True,
                    ),
                ),
                (
                    "normal_samples",
                    models.IntegerField(
                        blank=True,
                        help_text="Number of normal samples in training set",
                        null=True,
                    ),
                ),
                (
                    "training_date",
                    models.DateTimeField(
                        auto_now_add=True,
                        db_index=True,
                        help_text="When model was trained",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        db_index=True,
                        default=False,
                        help_text="Whether this is the active model version",
                    ),
                ),
                (
                    "validation_passed",
                    models.BooleanField(
                        default=False,
                        help_text="Whether model passed validation thresholds",
                    ),
                ),
                (
                    "model_file_path",
                    models.CharField(
                        blank=True,
                        help_text="Path to serialized model file (.pkl)",
                        max_length=500,
                    ),
                ),
                (
                    "model_size_bytes",
                    models.BigIntegerField(
                        blank=True, help_text="Size of model file in bytes", null=True
                    ),
                ),
                (
                    "hyperparameters",
                    models.JSONField(
                        default=dict,
                        help_text="Model hyperparameters used during training",
                    ),
                ),
                (
                    "feature_names",
                    models.JSONField(
                        default=list, help_text="List of feature names used by model"
                    ),
                ),
                (
                    "training_notes",
                    models.TextField(blank=True, help_text="Notes about training run"),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True, help_text="Error message if training failed"
                    ),
                ),
            ],
            options={
                "verbose_name": "ML Model Metrics",
                "verbose_name_plural": "ML Model Metrics",
                "db_table": "noc_ml_model_metrics",
                "ordering": ["-training_date"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="NOCAlertEvent",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "alert_type",
                    models.CharField(
                        choices=[
                            ("PREDICTIVE_SLA_BREACH", "Predictive SLA Breach"),
                            ("PREDICTIVE_DEVICE_FAILURE", "Predictive Device Failure"),
                            ("PREDICTIVE_STAFFING_GAP", "Predictive Staffing Gap"),
                            ("SLA_BREACH", "SLA Breach"),
                            ("TICKET_ESCALATED", "Ticket Escalated"),
                            ("DEVICE_OFFLINE", "Device Offline"),
                            ("DEVICE_SPOOF", "Device Spoofing Detected"),
                            ("GEOFENCE_BREACH", "Geofence Violation"),
                            ("ATTENDANCE_MISSING", "Attendance Missing"),
                            ("SYNC_DEGRADED", "Sync Health Degraded"),
                            ("SECURITY_ANOMALY", "Security Anomaly"),
                            ("WORK_ORDER_OVERDUE", "Work Order Overdue"),
                            ("ATTENDANCE_ANOMALY", "Attendance Anomaly"),
                            ("WRONG_PERSON_AT_SITE", "Wrong Person at Site"),
                            ("UNAUTHORIZED_SITE_ACCESS", "Unauthorized Site Access"),
                            ("IMPOSSIBLE_SHIFTS", "Impossible Consecutive Shifts"),
                            ("OVERTIME_VIOLATION", "Overtime Violation"),
                            ("BUDDY_PUNCHING", "Buddy Punching Detected"),
                            ("GPS_SPOOFING", "GPS Spoofing Suspected"),
                            ("BIOMETRIC_PATTERN_ANOMALY", "Biometric Pattern Anomaly"),
                            ("SCHEDULE_MISMATCH", "Schedule Mismatch"),
                            ("GUARD_INACTIVITY", "Guard Inactivity Detected"),
                            ("GPS_LOW_ACCURACY", "GPS Low Accuracy"),
                            ("TOUR_OVERDUE", "Tour Overdue"),
                            ("TOUR_INCOMPLETE", "Tour Incomplete"),
                        ],
                        max_length=50,
                        verbose_name="Alert Type",
                    ),
                ),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("INFO", "Informational"),
                            ("LOW", "Low"),
                            ("MEDIUM", "Medium"),
                            ("HIGH", "High"),
                            ("CRITICAL", "Critical"),
                        ],
                        max_length=20,
                        verbose_name="Severity",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("NEW", "New"),
                            ("ACKNOWLEDGED", "Acknowledged"),
                            ("ASSIGNED", "Assigned"),
                            ("ESCALATED", "Escalated"),
                            ("RESOLVED", "Resolved"),
                            ("SUPPRESSED", "Suppressed"),
                        ],
                        default="NEW",
                        max_length=20,
                        verbose_name="Status",
                    ),
                ),
                (
                    "dedup_key",
                    models.CharField(
                        db_index=True,
                        help_text="MD5 hash for alert de-duplication",
                        max_length=255,
                        verbose_name="Deduplication Key",
                    ),
                ),
                (
                    "correlation_id",
                    models.UUIDField(
                        blank=True,
                        db_index=True,
                        help_text="Groups related alerts from same root cause",
                        null=True,
                        verbose_name="Correlation ID",
                    ),
                ),
                (
                    "suppressed_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of duplicate alerts suppressed",
                        verbose_name="Suppressed Count",
                    ),
                ),
                (
                    "first_seen",
                    models.DateTimeField(auto_now_add=True, verbose_name="First Seen"),
                ),
                (
                    "last_seen",
                    models.DateTimeField(auto_now=True, verbose_name="Last Seen"),
                ),
                ("message", models.TextField(verbose_name="Alert Message")),
                (
                    "entity_type",
                    models.CharField(max_length=50, verbose_name="Entity Type"),
                ),
                ("entity_id", models.IntegerField(verbose_name="Entity ID")),
                ("metadata", models.JSONField(default=dict, verbose_name="Metadata")),
                ("acknowledged_at", models.DateTimeField(blank=True, null=True)),
                ("assigned_at", models.DateTimeField(blank=True, null=True)),
                ("escalated_at", models.DateTimeField(blank=True, null=True)),
                ("resolved_at", models.DateTimeField(blank=True, null=True)),
                (
                    "time_to_ack",
                    models.DurationField(
                        blank=True, null=True, verbose_name="Time to Acknowledge"
                    ),
                ),
                (
                    "time_to_resolve",
                    models.DurationField(
                        blank=True, null=True, verbose_name="Time to Resolve"
                    ),
                ),
                (
                    "calculated_priority",
                    models.IntegerField(
                        default=50,
                        help_text="ML-based business impact score (0-100)",
                        verbose_name="Calculated Priority",
                    ),
                ),
                (
                    "priority_features",
                    models.JSONField(
                        default=dict,
                        help_text="Feature values used for priority calculation",
                        verbose_name="Priority Features",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Alert Event",
                "verbose_name_plural": "NOC Alert Events",
                "db_table": "noc_alert_event",
                "ordering": ["-cdtz"],
            },
        ),
        migrations.CreateModel(
            name="NOCAuditLog",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "action",
                    models.CharField(
                        choices=[
                            ("ACKNOWLEDGE", "Alert Acknowledged"),
                            ("ASSIGN", "Alert Assigned"),
                            ("ESCALATE", "Alert Escalated"),
                            ("RESOLVE", "Alert Resolved"),
                            ("SUPPRESS", "Alert Suppressed"),
                            ("MAINTENANCE_CREATE", "Maintenance Window Created"),
                            ("MAINTENANCE_UPDATE", "Maintenance Window Updated"),
                            ("MAINTENANCE_DELETE", "Maintenance Window Deleted"),
                            ("EXPORT_DATA", "Data Exported"),
                            ("VIEW_SENSITIVE", "Sensitive Data Viewed"),
                            ("CONFIG_CHANGE", "Configuration Changed"),
                        ],
                        max_length=50,
                        verbose_name="Action",
                    ),
                ),
                (
                    "entity_type",
                    models.CharField(
                        default="unknown",
                        help_text="Type of entity acted upon (alert, incident, maintenance_window)",
                        max_length=50,
                        verbose_name="Entity Type",
                    ),
                ),
                (
                    "entity_id",
                    models.IntegerField(
                        default=0,
                        help_text="ID of the entity acted upon",
                        verbose_name="Entity ID",
                    ),
                ),
                (
                    "metadata",
                    models.JSONField(
                        default=dict,
                        help_text="Additional context (no sensitive data)",
                        verbose_name="Metadata",
                    ),
                ),
                ("ip_address", models.GenericIPAddressField(verbose_name="IP Address")),
                (
                    "user_agent",
                    models.TextField(blank=True, null=True, verbose_name="User Agent"),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, db_index=True, verbose_name="Created At"
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Audit Log",
                "verbose_name_plural": "NOC Audit Logs",
                "db_table": "noc_audit_log",
                "ordering": ["-created_at"],
                "managed": True,
            },
        ),
        migrations.CreateModel(
            name="NOCDashboardConfig",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "widget_preferences",
                    models.JSONField(
                        default=dict,
                        help_text="Widget visibility, order, and size settings",
                        verbose_name="Widget Preferences",
                    ),
                ),
                (
                    "default_filters",
                    models.JSONField(
                        default=dict,
                        help_text="Default client, severity, status filters",
                        verbose_name="Default Filters",
                    ),
                ),
                (
                    "refresh_interval_seconds",
                    models.IntegerField(
                        default=30,
                        help_text="Dashboard auto-refresh interval",
                        verbose_name="Refresh Interval (seconds)",
                    ),
                ),
                (
                    "alert_notification_enabled",
                    models.BooleanField(
                        default=True, verbose_name="Alert Notifications Enabled"
                    ),
                ),
                (
                    "notification_severities",
                    models.JSONField(
                        default=list,
                        help_text="Severities to receive notifications for (e.g., ['HIGH', 'CRITICAL'])",
                        verbose_name="Notification Severities",
                    ),
                ),
                (
                    "show_resolved_alerts",
                    models.BooleanField(
                        default=False, verbose_name="Show Resolved Alerts"
                    ),
                ),
                (
                    "alerts_per_page",
                    models.IntegerField(default=25, verbose_name="Alerts Per Page"),
                ),
                (
                    "theme",
                    models.CharField(
                        choices=[("light", "Light"), ("dark", "Dark")],
                        default="light",
                        max_length=20,
                        verbose_name="Theme",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Dashboard Config",
                "verbose_name_plural": "NOC Dashboard Configs",
                "db_table": "noc_dashboard_config",
            },
        ),
        migrations.CreateModel(
            name="NOCEventLog",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "event_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique event identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "event_type",
                    models.CharField(
                        choices=[
                            ("alert_created", "Alert Created"),
                            ("alert_updated", "Alert Updated"),
                            ("finding_created", "Finding Created"),
                            ("anomaly_detected", "Anomaly Detected"),
                            ("ticket_updated", "Ticket Updated"),
                            ("incident_updated", "Incident Updated"),
                            ("correlation_identified", "Correlation Identified"),
                            ("maintenance_window", "Maintenance Window"),
                            ("metrics_refresh", "Metrics Refresh"),
                        ],
                        db_index=True,
                        help_text="Type of event broadcast",
                        max_length=50,
                    ),
                ),
                (
                    "payload",
                    models.JSONField(
                        default=dict, help_text="Event payload data sent to clients"
                    ),
                ),
                (
                    "broadcast_at",
                    models.DateTimeField(
                        auto_now_add=True,
                        db_index=True,
                        help_text="When event was broadcast",
                    ),
                ),
                (
                    "recipient_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of WebSocket clients that received event",
                    ),
                ),
                (
                    "alert_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Related alert ID (if event_type is alert_*)",
                        null=True,
                    ),
                ),
                (
                    "finding_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Related finding ID (if event_type is finding_*)",
                        null=True,
                    ),
                ),
                (
                    "ticket_id",
                    models.IntegerField(
                        blank=True,
                        db_index=True,
                        help_text="Related ticket ID (if event_type is ticket_*)",
                        null=True,
                    ),
                ),
                (
                    "broadcast_success",
                    models.BooleanField(
                        default=True, help_text="Whether broadcast succeeded"
                    ),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True, help_text="Error message if broadcast failed"
                    ),
                ),
                (
                    "broadcast_latency_ms",
                    models.IntegerField(
                        blank=True,
                        help_text="Broadcast latency in milliseconds",
                        null=True,
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Event Log",
                "verbose_name_plural": "NOC Event Logs",
                "db_table": "noc_event_log",
                "ordering": ["-broadcast_at"],
                "abstract": False,
            },
        ),
        migrations.CreateModel(
            name="NOCExportHistory",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "entity_type",
                    models.CharField(
                        default="alerts",
                        help_text="Type of data exported",
                        max_length=20,
                        verbose_name="Entity Type",
                    ),
                ),
                (
                    "format",
                    models.CharField(
                        default="csv", max_length=10, verbose_name="Format"
                    ),
                ),
                (
                    "record_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of records exported",
                        verbose_name="Record Count",
                    ),
                ),
                (
                    "file_size_bytes",
                    models.BigIntegerField(
                        blank=True, null=True, verbose_name="File Size (Bytes)"
                    ),
                ),
                (
                    "filters_used",
                    models.JSONField(
                        default=dict,
                        help_text="Filter criteria applied to this export",
                        verbose_name="Filters Used",
                    ),
                ),
                (
                    "ip_address",
                    models.GenericIPAddressField(
                        blank=True, null=True, verbose_name="IP Address"
                    ),
                ),
                (
                    "expires_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="When the export file will be deleted (null = immediate download)",
                        null=True,
                        verbose_name="Expires At",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Export History",
                "verbose_name_plural": "NOC Export History",
                "db_table": "noc_export_history",
                "ordering": ["-cdtz"],
            },
        ),
        migrations.CreateModel(
            name="NOCExportTemplate",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Descriptive name for this export template",
                        max_length=100,
                        verbose_name="Template Name",
                    ),
                ),
                (
                    "description",
                    models.TextField(
                        blank=True,
                        help_text="Optional description of what this template exports",
                        verbose_name="Description",
                    ),
                ),
                (
                    "entity_type",
                    models.CharField(
                        choices=[
                            ("alerts", "Alerts"),
                            ("incidents", "Incidents"),
                            ("snapshots", "Metric Snapshots"),
                            ("audit", "Audit Logs"),
                        ],
                        default="alerts",
                        help_text="Type of data to export",
                        max_length=20,
                        verbose_name="Entity Type",
                    ),
                ),
                (
                    "format",
                    models.CharField(
                        choices=[("csv", "CSV"), ("json", "JSON")],
                        default="csv",
                        max_length=10,
                        verbose_name="Export Format",
                    ),
                ),
                (
                    "filters",
                    models.JSONField(
                        default=dict,
                        help_text="Filter criteria (client_ids, severities, statuses, date_ranges)",
                        verbose_name="Filters",
                    ),
                ),
                (
                    "columns",
                    django.contrib.postgres.fields.ArrayField(
                        base_field=models.CharField(max_length=50),
                        blank=True,
                        help_text="Specific columns to include (null = all columns)",
                        null=True,
                        size=None,
                        verbose_name="Columns",
                    ),
                ),
                (
                    "is_public",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this template is shared with team",
                        verbose_name="Public Template",
                    ),
                ),
                (
                    "usage_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of times this template has been used",
                        verbose_name="Usage Count",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Export Template",
                "verbose_name_plural": "NOC Export Templates",
                "db_table": "noc_export_templates",
                "ordering": ["-usage_count", "name"],
            },
        ),
        migrations.CreateModel(
            name="NOCIncident",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "title",
                    models.CharField(max_length=255, verbose_name="Incident Title"),
                ),
                ("description", models.TextField(verbose_name="Incident Description")),
                (
                    "severity",
                    models.CharField(
                        choices=[
                            ("CRITICAL", "Critical"),
                            ("HIGH", "High"),
                            ("MEDIUM", "Medium"),
                            ("LOW", "Low"),
                            ("INFO", "Informational"),
                        ],
                        default="MEDIUM",
                        max_length=20,
                        verbose_name="Severity",
                    ),
                ),
                (
                    "metadata",
                    models.JSONField(
                        default=dict,
                        help_text="Enrichment context and additional metadata",
                        verbose_name="Metadata",
                    ),
                ),
                (
                    "state",
                    models.CharField(
                        choices=[
                            ("NEW", "New"),
                            ("ACKNOWLEDGED", "Acknowledged"),
                            ("ASSIGNED", "Assigned"),
                            ("IN_PROGRESS", "In Progress"),
                            ("RESOLVED", "Resolved"),
                            ("CLOSED", "Closed"),
                        ],
                        default="NEW",
                        max_length=20,
                        verbose_name="State",
                    ),
                ),
                ("priority", models.CharField(max_length=20, verbose_name="Priority")),
                (
                    "sla_target",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="SLA Target Time"
                    ),
                ),
                (
                    "resolution_notes",
                    models.TextField(
                        blank=True, null=True, verbose_name="Resolution Notes"
                    ),
                ),
                (
                    "runbook_link",
                    models.URLField(
                        blank=True,
                        help_text="Link to resolution runbook or wiki",
                        null=True,
                        verbose_name="Runbook Link",
                    ),
                ),
                ("time_to_ack", models.DurationField(blank=True, null=True)),
                ("time_to_assign", models.DurationField(blank=True, null=True)),
                ("time_to_resolve", models.DurationField(blank=True, null=True)),
            ],
            options={
                "verbose_name": "NOC Incident",
                "verbose_name_plural": "NOC Incidents",
                "db_table": "noc_incident",
                "ordering": ["-cdtz"],
            },
        ),
        migrations.CreateModel(
            name="NOCMetricSnapshot",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "city",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        max_length=100,
                        null=True,
                        verbose_name="City",
                    ),
                ),
                (
                    "state",
                    models.CharField(
                        blank=True,
                        db_index=True,
                        max_length=100,
                        null=True,
                        verbose_name="State",
                    ),
                ),
                (
                    "window_start",
                    models.DateTimeField(
                        db_index=True, verbose_name="Window Start Time"
                    ),
                ),
                (
                    "window_end",
                    models.DateTimeField(db_index=True, verbose_name="Window End Time"),
                ),
                (
                    "computed_at",
                    models.DateTimeField(
                        auto_now_add=True, verbose_name="Computed Timestamp"
                    ),
                ),
                (
                    "tickets_open",
                    models.IntegerField(default=0, verbose_name="Open Tickets"),
                ),
                (
                    "tickets_overdue",
                    models.IntegerField(default=0, verbose_name="Overdue Tickets"),
                ),
                (
                    "tickets_by_priority",
                    models.JSONField(
                        default=dict,
                        help_text="Distribution: {'LOW': 5, 'MEDIUM': 10, 'HIGH': 3}",
                        verbose_name="Tickets by Priority",
                    ),
                ),
                (
                    "work_orders_pending",
                    models.IntegerField(default=0, verbose_name="Pending Work Orders"),
                ),
                (
                    "work_orders_overdue",
                    models.IntegerField(default=0, verbose_name="Overdue Work Orders"),
                ),
                (
                    "work_orders_status_mix",
                    models.JSONField(
                        default=dict, verbose_name="Work Order Status Mix"
                    ),
                ),
                (
                    "attendance_present",
                    models.IntegerField(default=0, verbose_name="Present Count"),
                ),
                (
                    "attendance_missing",
                    models.IntegerField(default=0, verbose_name="Missing Count"),
                ),
                (
                    "attendance_late",
                    models.IntegerField(default=0, verbose_name="Late Count"),
                ),
                (
                    "attendance_expected",
                    models.IntegerField(default=0, verbose_name="Expected Count"),
                ),
                (
                    "device_health_offline",
                    models.IntegerField(default=0, verbose_name="Offline Devices"),
                ),
                (
                    "device_health_alerts",
                    models.IntegerField(default=0, verbose_name="Device Alerts"),
                ),
                (
                    "device_health_total",
                    models.IntegerField(default=0, verbose_name="Total Devices"),
                ),
                (
                    "geofence_events_count",
                    models.IntegerField(default=0, verbose_name="Geofence Events"),
                ),
                (
                    "sync_health_score",
                    models.FloatField(default=100.0, verbose_name="Sync Health Score"),
                ),
                (
                    "security_anomalies",
                    models.IntegerField(default=0, verbose_name="Security Anomalies"),
                ),
            ],
            options={
                "verbose_name": "NOC Metric Snapshot",
                "verbose_name_plural": "NOC Metric Snapshots",
                "db_table": "noc_metric_snapshot",
                "ordering": ["-window_end"],
            },
        ),
        migrations.CreateModel(
            name="NOCMetricSnapshot1Day",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                ("date", models.DateField(db_index=True, verbose_name="Date")),
                (
                    "computed_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Computed At"),
                ),
                (
                    "tickets_open_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Tickets Open (Daily Avg)"
                    ),
                ),
                (
                    "tickets_open_min",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Open (Daily Min)"
                    ),
                ),
                (
                    "tickets_open_max",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Open (Daily Max)"
                    ),
                ),
                (
                    "tickets_overdue_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Tickets Overdue (Daily Avg)"
                    ),
                ),
                (
                    "tickets_overdue_min",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Overdue (Daily Min)"
                    ),
                ),
                (
                    "tickets_overdue_max",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Overdue (Daily Max)"
                    ),
                ),
                (
                    "work_orders_pending_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Work Orders Pending (Daily Avg)"
                    ),
                ),
                (
                    "work_orders_pending_min",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Pending (Daily Min)"
                    ),
                ),
                (
                    "work_orders_pending_max",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Pending (Daily Max)"
                    ),
                ),
                (
                    "work_orders_overdue_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Work Orders Overdue (Daily Avg)"
                    ),
                ),
                (
                    "work_orders_overdue_min",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Overdue (Daily Min)"
                    ),
                ),
                (
                    "work_orders_overdue_max",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Overdue (Daily Max)"
                    ),
                ),
                (
                    "attendance_present_avg",
                    models.FloatField(default=0.0, verbose_name="Present (Daily Avg)"),
                ),
                (
                    "attendance_present_min",
                    models.IntegerField(default=0, verbose_name="Present (Daily Min)"),
                ),
                (
                    "attendance_present_max",
                    models.IntegerField(default=0, verbose_name="Present (Daily Max)"),
                ),
                (
                    "attendance_missing_avg",
                    models.FloatField(default=0.0, verbose_name="Missing (Daily Avg)"),
                ),
                (
                    "attendance_missing_min",
                    models.IntegerField(default=0, verbose_name="Missing (Daily Min)"),
                ),
                (
                    "attendance_missing_max",
                    models.IntegerField(default=0, verbose_name="Missing (Daily Max)"),
                ),
                (
                    "device_health_offline_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Offline Devices (Daily Avg)"
                    ),
                ),
                (
                    "device_health_offline_min",
                    models.IntegerField(
                        default=0, verbose_name="Offline Devices (Daily Min)"
                    ),
                ),
                (
                    "device_health_offline_max",
                    models.IntegerField(
                        default=0, verbose_name="Offline Devices (Daily Max)"
                    ),
                ),
                (
                    "sync_health_score_avg",
                    models.FloatField(
                        default=100.0, verbose_name="Sync Health Score (Daily Avg)"
                    ),
                ),
                (
                    "sync_health_score_min",
                    models.FloatField(
                        default=100.0, verbose_name="Sync Health Score (Daily Min)"
                    ),
                ),
                (
                    "security_anomalies_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Anomalies (Daily Avg)"
                    ),
                ),
                (
                    "security_anomalies_max",
                    models.IntegerField(
                        default=0, verbose_name="Anomalies (Daily Max)"
                    ),
                ),
                (
                    "security_anomalies_sum",
                    models.IntegerField(
                        default=0, verbose_name="Anomalies (Daily Sum)"
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Metric Snapshot (1 Day)",
                "verbose_name_plural": "NOC Metric Snapshots (1 Day)",
                "db_table": "noc_metric_snapshot_1day",
                "ordering": ["-date"],
            },
        ),
        migrations.CreateModel(
            name="NOCMetricSnapshot1Hour",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "window_start",
                    models.DateTimeField(db_index=True, verbose_name="Window Start"),
                ),
                (
                    "window_end",
                    models.DateTimeField(db_index=True, verbose_name="Window End"),
                ),
                (
                    "computed_at",
                    models.DateTimeField(auto_now_add=True, verbose_name="Computed At"),
                ),
                (
                    "tickets_open_avg",
                    models.FloatField(default=0.0, verbose_name="Tickets Open (Avg)"),
                ),
                (
                    "tickets_open_min",
                    models.IntegerField(default=0, verbose_name="Tickets Open (Min)"),
                ),
                (
                    "tickets_open_max",
                    models.IntegerField(default=0, verbose_name="Tickets Open (Max)"),
                ),
                (
                    "tickets_open_sum",
                    models.IntegerField(default=0, verbose_name="Tickets Open (Sum)"),
                ),
                (
                    "tickets_overdue_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Tickets Overdue (Avg)"
                    ),
                ),
                (
                    "tickets_overdue_min",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Overdue (Min)"
                    ),
                ),
                (
                    "tickets_overdue_max",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Overdue (Max)"
                    ),
                ),
                (
                    "tickets_overdue_sum",
                    models.IntegerField(
                        default=0, verbose_name="Tickets Overdue (Sum)"
                    ),
                ),
                (
                    "work_orders_pending_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Work Orders Pending (Avg)"
                    ),
                ),
                (
                    "work_orders_pending_min",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Pending (Min)"
                    ),
                ),
                (
                    "work_orders_pending_max",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Pending (Max)"
                    ),
                ),
                (
                    "work_orders_pending_sum",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Pending (Sum)"
                    ),
                ),
                (
                    "work_orders_overdue_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Work Orders Overdue (Avg)"
                    ),
                ),
                (
                    "work_orders_overdue_min",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Overdue (Min)"
                    ),
                ),
                (
                    "work_orders_overdue_max",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Overdue (Max)"
                    ),
                ),
                (
                    "work_orders_overdue_sum",
                    models.IntegerField(
                        default=0, verbose_name="Work Orders Overdue (Sum)"
                    ),
                ),
                (
                    "attendance_present_avg",
                    models.FloatField(default=0.0, verbose_name="Present (Avg)"),
                ),
                (
                    "attendance_present_min",
                    models.IntegerField(default=0, verbose_name="Present (Min)"),
                ),
                (
                    "attendance_present_max",
                    models.IntegerField(default=0, verbose_name="Present (Max)"),
                ),
                (
                    "attendance_present_sum",
                    models.IntegerField(default=0, verbose_name="Present (Sum)"),
                ),
                (
                    "attendance_missing_avg",
                    models.FloatField(default=0.0, verbose_name="Missing (Avg)"),
                ),
                (
                    "attendance_missing_min",
                    models.IntegerField(default=0, verbose_name="Missing (Min)"),
                ),
                (
                    "attendance_missing_max",
                    models.IntegerField(default=0, verbose_name="Missing (Max)"),
                ),
                (
                    "attendance_missing_sum",
                    models.IntegerField(default=0, verbose_name="Missing (Sum)"),
                ),
                (
                    "device_health_offline_avg",
                    models.FloatField(
                        default=0.0, verbose_name="Offline Devices (Avg)"
                    ),
                ),
                (
                    "device_health_offline_min",
                    models.IntegerField(
                        default=0, verbose_name="Offline Devices (Min)"
                    ),
                ),
                (
                    "device_health_offline_max",
                    models.IntegerField(
                        default=0, verbose_name="Offline Devices (Max)"
                    ),
                ),
                (
                    "sync_health_score_avg",
                    models.FloatField(
                        default=100.0, verbose_name="Sync Health Score (Avg)"
                    ),
                ),
                (
                    "sync_health_score_min",
                    models.FloatField(
                        default=100.0, verbose_name="Sync Health Score (Min)"
                    ),
                ),
                (
                    "security_anomalies_avg",
                    models.FloatField(default=0.0, verbose_name="Anomalies (Avg)"),
                ),
                (
                    "security_anomalies_max",
                    models.IntegerField(default=0, verbose_name="Anomalies (Max)"),
                ),
                (
                    "security_anomalies_sum",
                    models.IntegerField(default=0, verbose_name="Anomalies (Sum)"),
                ),
            ],
            options={
                "verbose_name": "NOC Metric Snapshot (1 Hour)",
                "verbose_name_plural": "NOC Metric Snapshots (1 Hour)",
                "db_table": "noc_metric_snapshot_1hour",
                "ordering": ["-window_start"],
            },
        ),
        migrations.CreateModel(
            name="NOCSavedView",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Descriptive name for this saved view",
                        max_length=100,
                        verbose_name="View Name",
                    ),
                ),
                (
                    "description",
                    models.TextField(
                        blank=True,
                        help_text="Optional description of this view's purpose",
                        verbose_name="Description",
                    ),
                ),
                (
                    "filters",
                    models.JSONField(
                        default=dict,
                        help_text="Filter settings: client_ids, severities, statuses, time_range",
                        verbose_name="Filters",
                    ),
                ),
                (
                    "widget_layout",
                    models.JSONField(
                        default=list,
                        help_text="Dashboard widget configuration: positions, sizes, visibility",
                        verbose_name="Widget Layout",
                    ),
                ),
                (
                    "time_range_hours",
                    models.IntegerField(
                        default=24,
                        help_text="Default time window for metrics",
                        verbose_name="Default Time Range (hours)",
                    ),
                ),
                (
                    "refresh_interval_seconds",
                    models.IntegerField(
                        default=30,
                        help_text="Auto-refresh interval for real-time updates",
                        verbose_name="Refresh Interval (seconds)",
                    ),
                ),
                (
                    "is_default",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this is the user's default dashboard view",
                        verbose_name="Default View",
                    ),
                ),
                (
                    "is_shared",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this view is shared with other users",
                        verbose_name="Shared View",
                    ),
                ),
                (
                    "version",
                    models.IntegerField(
                        default=1,
                        help_text="View version for tracking changes",
                        verbose_name="Version",
                    ),
                ),
                (
                    "usage_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of times this view has been loaded",
                        verbose_name="Usage Count",
                    ),
                ),
                (
                    "last_used_at",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Last Used At"
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Saved View",
                "verbose_name_plural": "NOC Saved Views",
                "db_table": "noc_saved_views",
                "ordering": ["-is_default", "-last_used_at", "name"],
            },
        ),
        migrations.CreateModel(
            name="NOCScheduledExport",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "name",
                    models.CharField(
                        help_text="Descriptive name for this scheduled export",
                        max_length=100,
                        verbose_name="Schedule Name",
                    ),
                ),
                (
                    "schedule_type",
                    models.CharField(
                        choices=[
                            ("hourly", "Every Hour"),
                            ("daily", "Daily"),
                            ("weekly", "Weekly"),
                            ("monthly", "Monthly"),
                            ("custom", "Custom Cron Expression"),
                        ],
                        default="daily",
                        max_length=20,
                        verbose_name="Schedule Type",
                    ),
                ),
                (
                    "cron_expression",
                    models.CharField(
                        blank=True,
                        help_text="Required if schedule_type is 'custom' (e.g., '0 8 * * 1')",
                        max_length=100,
                        verbose_name="Cron Expression",
                    ),
                ),
                (
                    "delivery_method",
                    models.CharField(
                        choices=[
                            ("download", "Download Only (Store for 7 days)"),
                            ("email", "Email Delivery"),
                            ("webhook", "Webhook POST"),
                            ("both", "Email + Webhook"),
                        ],
                        default="download",
                        max_length=20,
                        verbose_name="Delivery Method",
                    ),
                ),
                (
                    "email_recipients",
                    django.contrib.postgres.fields.ArrayField(
                        base_field=models.EmailField(max_length=254),
                        blank=True,
                        help_text="Email addresses to receive exports",
                        null=True,
                        size=None,
                        verbose_name="Email Recipients",
                    ),
                ),
                (
                    "webhook_url",
                    models.URLField(
                        blank=True,
                        help_text="URL to POST export data or download link",
                        verbose_name="Webhook URL",
                    ),
                ),
                (
                    "webhook_headers",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Custom HTTP headers for webhook requests",
                        verbose_name="Webhook Headers",
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        default=True,
                        help_text="Whether this scheduled export is currently running",
                        verbose_name="Active",
                    ),
                ),
                (
                    "last_run_at",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Last Run At"
                    ),
                ),
                (
                    "next_run_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="Calculated next execution time",
                        null=True,
                        verbose_name="Next Run At",
                    ),
                ),
                (
                    "run_count",
                    models.IntegerField(
                        default=0,
                        help_text="Total number of successful executions",
                        verbose_name="Run Count",
                    ),
                ),
                (
                    "error_count",
                    models.IntegerField(
                        default=0,
                        help_text="Consecutive errors (disables after 5)",
                        verbose_name="Error Count",
                    ),
                ),
                (
                    "last_error",
                    models.TextField(
                        blank=True,
                        help_text="Most recent error message",
                        verbose_name="Last Error",
                    ),
                ),
            ],
            options={
                "verbose_name": "NOC Scheduled Export",
                "verbose_name_plural": "NOC Scheduled Exports",
                "db_table": "noc_scheduled_exports",
                "ordering": ["next_run_at"],
            },
        ),
        migrations.CreateModel(
            name="PlaybookExecution",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "execution_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending - Awaiting approval"),
                            ("RUNNING", "Running - Execution in progress"),
                            ("SUCCESS", "Success - All actions completed"),
                            ("PARTIAL", "Partial Success - Some actions failed"),
                            ("FAILED", "Failed - Execution failed"),
                            ("CANCELLED", "Cancelled - Manually stopped"),
                        ],
                        db_index=True,
                        default="PENDING",
                        help_text="Current execution status",
                        max_length=20,
                    ),
                ),
                (
                    "action_results",
                    models.JSONField(
                        default=list,
                        help_text="Results for each action: [{action, status, output, duration, error}, ...]",
                    ),
                ),
                (
                    "started_at",
                    models.DateTimeField(
                        blank=True,
                        db_index=True,
                        help_text="When execution started",
                        null=True,
                    ),
                ),
                (
                    "completed_at",
                    models.DateTimeField(
                        blank=True, help_text="When execution completed", null=True
                    ),
                ),
                (
                    "duration_seconds",
                    models.FloatField(
                        blank=True,
                        help_text="Total execution duration in seconds",
                        null=True,
                    ),
                ),
                (
                    "requires_approval",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this execution requires manual approval",
                    ),
                ),
                (
                    "approved_at",
                    models.DateTimeField(
                        blank=True, help_text="When execution was approved", null=True
                    ),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True, help_text="Error message if execution failed"
                    ),
                ),
                (
                    "execution_context",
                    models.JSONField(
                        default=dict,
                        help_text="Additional context about execution environment",
                    ),
                ),
            ],
            options={
                "verbose_name": "Playbook Execution",
                "verbose_name_plural": "Playbook Executions",
                "db_table": "noc_playbook_execution",
                "ordering": ["-cdtz"],
            },
        ),
        migrations.CreateModel(
            name="PredictiveAlertTracking",
            fields=[
                (
                    "cdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was created",
                        verbose_name="Created date",
                    ),
                ),
                (
                    "mdtz",
                    models.DateTimeField(
                        default=apps.peoples.models.base_model.now,
                        help_text="When this record was last modified",
                        verbose_name="Modified date",
                    ),
                ),
                (
                    "ctzoffset",
                    models.IntegerField(
                        default=-1,
                        help_text="User's timezone offset in minutes",
                        verbose_name="Timezone offset",
                    ),
                ),
                (
                    "prediction_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        primary_key=True,
                        serialize=False,
                        verbose_name="Prediction ID",
                    ),
                ),
                (
                    "prediction_type",
                    models.CharField(
                        choices=[
                            ("sla_breach", "SLA Breach"),
                            ("device_failure", "Device Failure"),
                            ("staffing_gap", "Staffing Gap"),
                        ],
                        db_index=True,
                        max_length=50,
                        verbose_name="Prediction Type",
                    ),
                ),
                (
                    "predicted_at",
                    models.DateTimeField(
                        auto_now_add=True, db_index=True, verbose_name="Predicted At"
                    ),
                ),
                (
                    "predicted_probability",
                    models.FloatField(
                        help_text="Probability score 0.0-1.0 from ML model",
                        verbose_name="Predicted Probability",
                    ),
                ),
                (
                    "entity_type",
                    models.CharField(
                        help_text="ticket, device, shift, etc.",
                        max_length=50,
                        verbose_name="Entity Type",
                    ),
                ),
                ("entity_id", models.IntegerField(verbose_name="Entity ID")),
                (
                    "entity_metadata",
                    models.JSONField(
                        default=dict,
                        help_text="Snapshot of entity state at prediction time",
                        verbose_name="Entity Metadata",
                    ),
                ),
                (
                    "feature_values",
                    models.JSONField(
                        default=dict,
                        help_text="Feature vector used for prediction",
                        verbose_name="Feature Values",
                    ),
                ),
                (
                    "validation_deadline",
                    models.DateTimeField(
                        db_index=True,
                        help_text="When to check if prediction came true",
                        verbose_name="Validation Deadline",
                    ),
                ),
                (
                    "actual_outcome",
                    models.BooleanField(
                        blank=True,
                        help_text="True if event occurred, False if prevented/didn't occur",
                        null=True,
                        verbose_name="Actual Outcome",
                    ),
                ),
                (
                    "validated_at",
                    models.DateTimeField(
                        blank=True, null=True, verbose_name="Validated At"
                    ),
                ),
                (
                    "prediction_correct",
                    models.BooleanField(
                        blank=True,
                        help_text="True if prediction matched outcome",
                        null=True,
                        verbose_name="Prediction Correct",
                    ),
                ),
                (
                    "confidence_bucket",
                    models.CharField(
                        help_text="low (<0.6), medium (0.6-0.75), high (0.75-0.9), very_high (>0.9)",
                        max_length=20,
                        verbose_name="Confidence Bucket",
                    ),
                ),
                (
                    "alert_acknowledged",
                    models.BooleanField(
                        default=False,
                        help_text="Whether operator acted on predictive alert",
                        verbose_name="Alert Acknowledged",
                    ),
                ),
                (
                    "preventive_action_taken",
                    models.BooleanField(
                        default=False,
                        help_text="Whether action was taken to prevent predicted event",
                        verbose_name="Preventive Action Taken",
                    ),
                ),
            ],
            options={
                "verbose_name": "Predictive Alert Tracking",
                "verbose_name_plural": "Predictive Alert Tracking Records",
                "db_table": "noc_predictive_alert_tracking",
                "ordering": ["-predicted_at"],
            },
        ),
    ]
