openapi: 3.0.3
info:
  title: IntelliWiz REST API
  version: 1.0.0
  description: |
    Enterprise Facility Management Platform REST API

    **Migration Note:** GraphQL removed October 2025. All endpoints now REST-based.

    **Features:**
    - JWT authentication
    - Multi-tenant isolation
    - WebSocket real-time sync
    - 45+ production endpoints
    - 50-65% faster than GraphQL

  contact:
    email: dev-team@intelliwiz.com

servers:
  - url: http://localhost:8000
    description: Development server
  - url: https://api.example.com
    description: Production server

security:
  - bearerAuth: []

components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
      description: JWT access token from /api/v1/auth/login/

  schemas:
    Error:
      type: object
      properties:
        success:
          type: boolean
          example: false
        error:
          type: object
          properties:
            code:
              type: string
              example: VALIDATION_ERROR
            message:
              type: string
              example: Invalid input data
            details:
              type: object
        correlation_id:
          type: string
          format: uuid

    PaginatedResponse:
      type: object
      properties:
        count:
          type: integer
          example: 150
        next:
          type: string
          nullable: true
          example: http://api.example.com/api/v1/people/?cursor=xyz
        previous:
          type: string
          nullable: true
        results:
          type: array
          items: {}

paths:
  /api/v1/auth/login/:
    post:
      summary: Login and obtain JWT tokens
      tags: [Authentication]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [username, password]
              properties:
                username:
                  type: string
                password:
                  type: string
                  format: password
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  access:
                    type: string
                    description: JWT access token (15min expiry)
                  refresh:
                    type: string
                    description: JWT refresh token (7 day expiry)

  /api/v1/people/:
    get:
      summary: List users
      tags: [People]
      security:
        - bearerAuth: []
      parameters:
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: page_size
          in: query
          schema:
            type: integer
            default: 50
        - name: search
          in: query
          schema:
            type: string
      responses:
        '200':
          description: User list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'

  /api/v1/operations/jobs/:
    get:
      summary: List jobs (work orders)
      tags: [Operations]
      security:
        - bearerAuth: []
      parameters:
        - name: status
          in: query
          schema:
            type: string
            enum: [pending, in_progress, completed]
        - name: date_from
          in: query
          schema:
            type: string
            format: date
      responses:
        '200':
          description: Job list
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PaginatedResponse'

tags:
  - name: Authentication
    description: JWT-based authentication
  - name: People
    description: User management
  - name: Operations
    description: Jobs, tasks, and work orders
  - name: Attendance
    description: Attendance tracking with GPS
  - name: HelpDesk
    description: Ticketing system
  - name: Reports
    description: Report generation
  - name: Biometrics
    description: Face and voice recognition
