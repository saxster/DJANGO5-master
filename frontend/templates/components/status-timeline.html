{% comment %}
Status Timeline Component - Workflow tracking for managers

USAGE:
  {% include 'components/status-timeline.html' with events=timeline_events %}

Where events is a list of dicts:
  [
    {
      'status': 'Created',
      'user': 'John Manager',
      'timestamp': '2025-01-04 09:30',
      'icon': 'add_circle',
      'variant': 'info',
      'details': 'Work permit created for Site A'
    },
    ...
  ]
{% endcomment %}

<div class="yt-timeline {{ class|default:'' }}">

  {% if title %}
    <h3 class="yt-timeline__title">{{ title }}</h3>
  {% endif %}

  <div class="yt-timeline__track">
    {% for event in events %}
      <div class="yt-timeline__item yt-timeline__item--{{ event.variant|default:'neutral' }}">

        {# Icon #}
        <div class="yt-timeline__icon-wrapper">
          <i class="material-icons yt-timeline__icon">{{ event.icon|default:'circle' }}</i>
        </div>

        {# Content #}
        <div class="yt-timeline__content">
          <div class="yt-timeline__header">
            <span class="yt-timeline__status">{{ event.status }}</span>
            <span class="yt-timeline__timestamp">{{ event.timestamp }}</span>
          </div>

          {% if event.user %}
            <div class="yt-timeline__user">
              <i class="material-icons" aria-hidden="true">person</i>
              {{ event.user }}
            </div>
          {% endif %}

          {% if event.details %}
            <div class="yt-timeline__details">{{ event.details }}</div>
          {% endif %}
        </div>

      </div>
    {% empty %}
      {% include 'components/empty-state.html' with
        icon='history'
        title='No timeline events'
        message='Activity history will appear here'
      %}
    {% endfor %}
  </div>

</div>

<style>
.yt-timeline {
  background: var(--bg-surface);
  border: 1px solid var(--border-default);
  border-radius: var(--radius-md);
  padding: var(--space-4);
}

.yt-timeline__title {
  font-size: var(--text-lg);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
  margin: 0 0 var(--space-4);
  padding-bottom: var(--space-3);
  border-bottom: 1px solid var(--border-default);
}

.yt-timeline__track {
  position: relative;
  padding-left: var(--space-2);
}

/* Vertical line connecting events */
.yt-timeline__track::before {
  content: '';
  position: absolute;
  left: 18px;
  top: 24px;
  bottom: 24px;
  width: 2px;
  background: var(--border-default);
}

.yt-timeline__item {
  display: flex;
  gap: var(--space-4);
  padding-bottom: var(--space-6);
  position: relative;
}

.yt-timeline__item:last-child {
  padding-bottom: 0;
}

.yt-timeline__icon-wrapper {
  width: 40px;
  height: 40px;
  background: var(--bg-muted);
  border: 2px solid var(--border-default);
  border-radius: var(--radius-full);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
  position: relative;
  z-index: 1;
}

.yt-timeline__icon {
  font-size: 20px;
  color: var(--text-muted);
}

/* Status variants */
.yt-timeline__item--success .yt-timeline__icon-wrapper {
  background: var(--color-success-100);
  border-color: var(--color-success-600);
}

.yt-timeline__item--success .yt-timeline__icon {
  color: var(--color-success-700);
}

.yt-timeline__item--danger .yt-timeline__icon-wrapper {
  background: var(--color-danger-100);
  border-color: var(--color-danger-600);
}

.yt-timeline__item--danger .yt-timeline__icon {
  color: var(--color-danger-700);
}

.yt-timeline__item--warning .yt-timeline__icon-wrapper {
  background: var(--color-warning-100);
  border-color: var(--color-warning-600);
}

.yt-timeline__item--warning .yt-timeline__icon {
  color: var(--color-warning-700);
}

.yt-timeline__item--info .yt-timeline__icon-wrapper {
  background: var(--color-info-100);
  border-color: var(--color-info-600);
}

.yt-timeline__item--info .yt-timeline__icon {
  color: var(--color-info-700);
}

.yt-timeline__content {
  flex: 1;
  min-width: 0;
}

.yt-timeline__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-3);
  margin-bottom: var(--space-2);
  flex-wrap: wrap;
}

.yt-timeline__status {
  font-size: var(--text-base);
  font-weight: var(--font-semibold);
  color: var(--text-primary);
}

.yt-timeline__timestamp {
  font-size: var(--text-xs);
  font-family: var(--font-mono);
  color: var(--text-muted);
}

.yt-timeline__user {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: var(--text-sm);
  color: var(--text-secondary);
  margin-bottom: var(--space-1);
}

.yt-timeline__user .material-icons {
  font-size: 16px;
  color: var(--text-muted);
}

.yt-timeline__details {
  font-size: var(--text-sm);
  color: var(--text-secondary);
  line-height: var(--leading-relaxed);
}

/* Dark mode */
.dark .yt-timeline__track::before {
  background: var(--border-default);
}

.dark .yt-timeline__item--success .yt-timeline__icon-wrapper {
  background: rgba(34, 197, 94, 0.15);
}

.dark .yt-timeline__item--danger .yt-timeline__icon-wrapper {
  background: rgba(248, 113, 113, 0.15);
}

.dark .yt-timeline__item--warning .yt-timeline__icon-wrapper {
  background: rgba(245, 158, 11, 0.15);
}

.dark .yt-timeline__item--info .yt-timeline__icon-wrapper {
  background: rgba(56, 189, 248, 0.15);
}

/* Print */
@media print {
  .yt-timeline {
    border: 1pt solid #000 !important;
    box-shadow: none;
  }

  .yt-timeline__track::before {
    background: #ccc !important;
  }

  .yt-timeline__icon-wrapper {
    border-color: #000 !important;
  }
}
</style>
