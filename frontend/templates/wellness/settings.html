{% extends "globals/base_modern.html" %}

{% block page_title %}Wellness Settings{% endblock page_title %}
{% block page_subtitle %}<p class="page-subtitle">Customize your wellness experience and privacy preferences</p>{% endblock page_subtitle %}

{% block extra_css %}
<style>
  /* Wellness Settings Styles */
  .settings-container {
    max-width: 900px;
    margin: 0 auto;
  }

  .settings-nav {
    display: flex;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 30px;
    overflow: hidden;
  }

  .nav-tab {
    flex: 1;
    padding: 20px;
    text-align: center;
    background: white;
    border: none;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    color: #666;
    transition: all 0.2s ease;
    border-right: 1px solid #f0f0f0;
  }

  .nav-tab:last-child {
    border-right: none;
  }

  .nav-tab:hover {
    background: #f8f9fa;
  }

  .nav-tab.active {
    background: #377dff;
    color: white;
  }

  .nav-tab i {
    display: block;
    margin-bottom: 8px;
    font-size: 20px;
  }

  .settings-section {
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    margin-bottom: 30px;
    display: none;
  }

  .settings-section.active {
    display: block;
  }

  .section-header {
    padding: 30px 30px 0;
    border-bottom: 1px solid #f0f0f0;
    margin-bottom: 30px;
  }

  .section-title {
    font-size: 24px;
    font-weight: 600;
    color: #333;
    margin-bottom: 10px;
  }

  .section-description {
    color: #666;
    line-height: 1.6;
    margin-bottom: 30px;
  }

  .settings-content {
    padding: 0 30px 30px;
  }

  .setting-group {
    margin-bottom: 30px;
    padding-bottom: 30px;
    border-bottom: 1px solid #f0f0f0;
  }

  .setting-group:last-child {
    border-bottom: none;
    margin-bottom: 0;
  }

  .group-title {
    font-size: 18px;
    font-weight: 600;
    color: #333;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
  }

  .group-title i {
    margin-right: 10px;
    color: #377dff;
  }

  .group-description {
    color: #666;
    font-size: 14px;
    margin-bottom: 20px;
    line-height: 1.5;
  }

  .setting-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    border-bottom: 1px solid #f8f9fa;
  }

  .setting-item:last-child {
    border-bottom: none;
  }

  .setting-info {
    flex: 1;
    margin-right: 20px;
  }

  .setting-label {
    font-size: 16px;
    font-weight: 500;
    color: #333;
    margin-bottom: 5px;
  }

  .setting-description {
    font-size: 13px;
    color: #666;
    line-height: 1.4;
  }

  .setting-control {
    flex-shrink: 0;
  }

  /* Toggle Switch */
  .toggle-switch {
    position: relative;
    width: 50px;
    height: 24px;
    background: #ccc;
    border-radius: 24px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .toggle-switch.active {
    background: #377dff;
  }

  .toggle-switch::before {
    content: '';
    position: absolute;
    top: 2px;
    left: 2px;
    width: 20px;
    height: 20px;
    background: white;
    border-radius: 50%;
    transition: all 0.2s ease;
  }

  .toggle-switch.active::before {
    left: 28px;
  }

  /* Form Controls */
  .form-control {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 14px;
    transition: border-color 0.2s ease;
  }

  .form-control:focus {
    outline: none;
    border-color: #377dff;
  }

  .form-control-sm {
    width: 200px;
    padding: 8px 12px;
  }

  .form-select {
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 8px center;
    background-repeat: no-repeat;
    background-size: 16px;
    padding-right: 40px;
  }

  /* Category Selection */
  .category-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-top: 15px;
  }

  .category-card {
    padding: 20px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    background: white;
  }

  .category-card:hover {
    border-color: #377dff;
    background: #f8faff;
  }

  .category-card.active {
    border-color: #377dff;
    background: #377dff;
    color: white;
  }

  .category-card i {
    font-size: 24px;
    margin-bottom: 10px;
    display: block;
  }

  .category-name {
    font-size: 13px;
    font-weight: 500;
  }

  /* Privacy Matrix */
  .privacy-matrix {
    margin-top: 20px;
  }

  .matrix-header {
    display: grid;
    grid-template-columns: 2fr repeat(4, 1fr);
    gap: 10px;
    padding: 15px 0;
    border-bottom: 2px solid #f0f0f0;
    font-weight: 500;
    font-size: 13px;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .matrix-row {
    display: grid;
    grid-template-columns: 2fr repeat(4, 1fr);
    gap: 10px;
    padding: 15px 0;
    border-bottom: 1px solid #f8f9fa;
    align-items: center;
  }

  .matrix-item {
    font-size: 14px;
    color: #333;
  }

  .matrix-toggle {
    justify-self: center;
  }

  .matrix-toggle .toggle-switch {
    width: 40px;
    height: 20px;
  }

  .matrix-toggle .toggle-switch::before {
    width: 16px;
    height: 16px;
  }

  .matrix-toggle .toggle-switch.active::before {
    left: 22px;
  }

  /* Progress Visualization */
  .progress-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    background: #f8f9fa;
    padding: 20px;
    border-radius: 8px;
    text-align: center;
  }

  .stat-value {
    font-size: 24px;
    font-weight: bold;
    color: #377dff;
    margin-bottom: 5px;
  }

  .stat-label {
    font-size: 12px;
    color: #666;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Action Buttons */
  .settings-actions {
    display: flex;
    gap: 15px;
    justify-content: flex-end;
    margin-top: 30px;
    padding-top: 30px;
    border-top: 1px solid #f0f0f0;
  }

  .btn {
    padding: 12px 24px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    text-decoration: none;
    transition: all 0.2s ease;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .btn-primary {
    background: #377dff;
    color: white;
  }

  .btn-primary:hover {
    background: #2c63e6;
  }

  .btn-secondary {
    background: #f8f9fa;
    color: #666;
    border: 1px solid #dee2e6;
  }

  .btn-secondary:hover {
    background: #e9ecef;
  }

  .btn-danger {
    background: #dc3545;
    color: white;
  }

  .btn-danger:hover {
    background: #c82333;
  }

  /* Alert Styles */
  .alert {
    padding: 15px 20px;
    border-radius: 8px;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .alert-info {
    background: #e3f2fd;
    color: #1565c0;
    border: 1px solid #bbdefb;
  }

  .alert-warning {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffd700;
  }

  .alert-success {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
  }

  /* Responsive Design */
  @media (max-width: 768px) {
    .settings-nav {
      flex-direction: column;
    }

    .nav-tab {
      border-right: none;
      border-bottom: 1px solid #f0f0f0;
    }

    .nav-tab:last-child {
      border-bottom: none;
    }

    .section-header, .settings-content {
      padding: 20px;
    }

    .setting-item {
      flex-direction: column;
      align-items: flex-start;
      gap: 15px;
    }

    .setting-info {
      margin-right: 0;
    }

    .matrix-header, .matrix-row {
      grid-template-columns: 1fr;
      text-align: center;
    }

    .category-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .settings-actions {
      flex-direction: column;
    }
  }
</style>
{% endblock extra_css %}

{% block content %}
<div class="settings-container">
  <!-- Navigation Tabs -->
  <div class="settings-nav">
    <button class="nav-tab active" onclick="showSection('preferences')">
      <i class="material-icons">tune</i>
      <span>Preferences</span>
    </button>
    <button class="nav-tab" onclick="showSection('privacy')">
      <i class="material-icons">lock</i>
      <span>Privacy</span>
    </button>
    <button class="nav-tab" onclick="showSection('notifications')">
      <i class="material-icons">notifications</i>
      <span>Notifications</span>
    </button>
    <button class="nav-tab" onclick="showSection('progress')">
      <i class="material-icons">insights</i>
      <span>Progress</span>
    </button>
    <button class="nav-tab" onclick="showSection('data')">
      <i class="material-icons">storage</i>
      <span>Data</span>
    </button>
  </div>

  <!-- Preferences Section -->
  <div class="settings-section active" id="preferences">
    <div class="section-header">
      <h2 class="section-title">Wellness Preferences</h2>
      <p class="section-description">
        Customize your wellness experience to match your interests and goals. These settings help us provide more relevant content and recommendations.
      </p>
    </div>

    <div class="settings-content">
      <!-- Content Preferences -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">psychology</i>
          Content Preferences
        </h3>
        <p class="group-description">
          Select the wellness topics that interest you most. We'll prioritize content from these categories in your recommendations.
        </p>

        <div class="category-grid">
          <div class="category-card active" data-category="mental_health">
            <i class="material-icons">psychology</i>
            <div class="category-name">Mental Health</div>
          </div>
          <div class="category-card active" data-category="stress_management">
            <i class="material-icons">healing</i>
            <div class="category-name">Stress Management</div>
          </div>
          <div class="category-card" data-category="physical_wellness">
            <i class="material-icons">fitness_center</i>
            <div class="category-name">Physical Wellness</div>
          </div>
          <div class="category-card active" data-category="mindfulness">
            <i class="material-icons">self_improvement</i>
            <div class="category-name">Mindfulness</div>
          </div>
          <div class="category-card" data-category="workplace_health">
            <i class="material-icons">work</i>
            <div class="category-name">Workplace Health</div>
          </div>
          <div class="category-card" data-category="sleep_hygiene">
            <i class="material-icons">bedtime</i>
            <div class="category-name">Sleep Hygiene</div>
          </div>
          <div class="category-card" data-category="nutrition_basics">
            <i class="material-icons">restaurant</i>
            <div class="category-name">Nutrition</div>
          </div>
          <div class="category-card" data-category="preventive_care">
            <i class="material-icons">health_and_safety</i>
            <div class="category-name">Preventive Care</div>
          </div>
        </div>
      </div>

      <!-- Content Delivery Settings -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">schedule</i>
          Content Delivery
        </h3>
        <p class="group-description">
          Customize when and how you receive wellness content to fit your schedule and preferences.
        </p>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Preferred Content Length</div>
            <div class="setting-description">Choose the ideal length for your wellness content</div>
          </div>
          <div class="setting-control">
            <select class="form-control form-control-sm form-select" id="contentLength">
              <option value="quick_tip">Quick Tips (1 min)</option>
              <option value="short_read" selected>Short Reads (3 min)</option>
              <option value="deep_dive">Deep Dives (7 min)</option>
              <option value="interactive">Interactive Content</option>
            </select>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Daily Wellness Tips</div>
            <div class="setting-description">Receive a personalized wellness tip each day</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Preferred Tip Time</div>
            <div class="setting-description">When would you like to receive your daily wellness tip?</div>
          </div>
          <div class="setting-control">
            <input type="time" class="form-control form-control-sm" value="09:00">
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Contextual Content</div>
            <div class="setting-description">Receive relevant wellness content based on your journal entries</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>

      <!-- Personalization Settings -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">person</i>
          Personalization
        </h3>
        <p class="group-description">
          Help us provide better recommendations by sharing information about your wellness goals and preferences.
        </p>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Evidence Level Preference</div>
            <div class="setting-description">Prefer content with higher evidence quality</div>
          </div>
          <div class="setting-control">
            <select class="form-control form-control-sm form-select">
              <option value="any">Any Evidence Level</option>
              <option value="high" selected>High Evidence Only</option>
              <option value="research">Research-Based Only</option>
            </select>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Field Worker Adaptations</div>
            <div class="setting-description">Show content specifically adapted for field work environments</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Privacy Section -->
  <div class="settings-section" id="privacy">
    <div class="section-header">
      <h2 class="section-title">Privacy Settings</h2>
      <p class="section-description">
        Control who can access your wellness data and how it's used. Your privacy is important to us, and you have full control over your information.
      </p>
    </div>

    <div class="settings-content">
      <div class="alert alert-info">
        <i class="material-icons">info</i>
        <span>All sensitive wellness data (mood, stress levels) is always kept private by default.</span>
      </div>

      <!-- Data Sharing Controls -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">share</i>
          Data Sharing
        </h3>

        <div class="privacy-matrix">
          <div class="matrix-header">
            <div>Data Type</div>
            <div>Private</div>
            <div>Team</div>
            <div>Manager</div>
            <div>Anonymous</div>
          </div>

          <div class="matrix-row">
            <div class="matrix-item">Journal Entry Titles</div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
          </div>

          <div class="matrix-row">
            <div class="matrix-item">Wellness Progress</div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
          </div>

          <div class="matrix-row">
            <div class="matrix-item">Content Preferences</div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
          </div>

          <div class="matrix-row">
            <div class="matrix-item">Mood & Stress Data</div>
            <div class="matrix-toggle"><div class="toggle-switch active" onclick="toggleSetting(this)"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch disabled"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch disabled"></div></div>
            <div class="matrix-toggle"><div class="toggle-switch" onclick="toggleSetting(this)"></div></div>
          </div>
        </div>
      </div>

      <!-- Consent Management -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">verified_user</i>
          Consent Management
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Wellness Analytics</div>
            <div class="setting-description">Allow anonymous analysis of wellness data to improve recommendations</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Crisis Intervention</div>
            <div class="setting-description">Enable alerts to designated contacts if content suggests crisis situations</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Research Participation</div>
            <div class="setting-description">Allow anonymized data to be used for wellness research studies</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Notifications Section -->
  <div class="settings-section" id="notifications">
    <div class="section-header">
      <h2 class="section-title">Notification Preferences</h2>
      <p class="section-description">
        Choose how and when you'd like to be notified about wellness content, achievements, and reminders.
      </p>
    </div>

    <div class="settings-content">
      <!-- Achievement Notifications -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">emoji_events</i>
          Achievements & Milestones
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Streak Milestones</div>
            <div class="setting-description">Get notified when you reach wellness engagement streaks</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Progress Achievements</div>
            <div class="setting-description">Celebrate when you complete wellness goals and milestones</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>

      <!-- Content Notifications -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">auto_awesome</i>
          Content Recommendations
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">New Content Alerts</div>
            <div class="setting-description">Get notified when new content in your preferred categories is available</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Contextual Suggestions</div>
            <div class="setting-description">Receive wellness content suggestions based on your journal patterns</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>

      <!-- Reminder Settings -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">schedule</i>
          Reminders
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Journal Entry Reminders</div>
            <div class="setting-description">Gentle reminders to make journal entries</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Wellness Break Reminders</div>
            <div class="setting-description">Reminders to take wellness breaks during work</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Progress Section -->
  <div class="settings-section" id="progress">
    <div class="section-header">
      <h2 class="section-title">Progress Overview</h2>
      <p class="section-description">
        View your wellness journey progress, streaks, and engagement statistics.
      </p>
    </div>

    <div class="settings-content">
      <div class="progress-stats">
        <div class="stat-card">
          <div class="stat-value">24</div>
          <div class="stat-label">Total Entries</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">7</div>
          <div class="stat-label">Current Streak</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">42</div>
          <div class="stat-label">Longest Streak</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">156</div>
          <div class="stat-label">Content Viewed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">89</div>
          <div class="stat-label">Content Completed</div>
        </div>
        <div class="stat-card">
          <div class="stat-value">12h</div>
          <div class="stat-label">Time Invested</div>
        </div>
      </div>

      <!-- Achievement Display -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">emoji_events</i>
          Achievements Earned
        </h3>
        <p class="group-description">
          Badges and milestones you've earned on your wellness journey.
        </p>

        <div class="achievement-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
          <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center;">
            <div style="font-size: 32px; margin-bottom: 10px;">üèÜ</div>
            <div style="font-weight: 500; margin-bottom: 5px;">Week Warrior</div>
            <div style="font-size: 12px; color: #666;">7-day engagement streak</div>
          </div>
          <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center;">
            <div style="font-size: 32px; margin-bottom: 10px;">üìö</div>
            <div style="font-weight: 500; margin-bottom: 5px;">Content Explorer</div>
            <div style="font-size: 12px; color: #666;">Viewed 50+ wellness articles</div>
          </div>
          <div style="padding: 20px; background: #f8f9fa; border-radius: 8px; text-align: center;">
            <div style="font-size: 32px; margin-bottom: 10px;">üíô</div>
            <div style="font-weight: 500; margin-bottom: 5px;">Wellness Advocate</div>
            <div style="font-size: 12px; color: #666;">Shared 10+ wellness resources</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Data Management Section -->
  <div class="settings-section" id="data">
    <div class="section-header">
      <h2 class="section-title">Data Management</h2>
      <p class="section-description">
        Manage your wellness data, including backup, export, and deletion options.
      </p>
    </div>

    <div class="settings-content">
      <!-- Data Export -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">download</i>
          Data Export
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Export Journal Entries</div>
            <div class="setting-description">Download all your journal entries in JSON or CSV format</div>
          </div>
          <div class="setting-control">
            <button class="btn btn-secondary" onclick="exportData('journal')">
              <i class="material-icons">file_download</i>
              Export
            </button>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Export Wellness Progress</div>
            <div class="setting-description">Download your wellness progress and interaction data</div>
          </div>
          <div class="setting-control">
            <button class="btn btn-secondary" onclick="exportData('progress')">
              <i class="material-icons">file_download</i>
              Export
            </button>
          </div>
        </div>
      </div>

      <!-- Data Retention -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">schedule_send</i>
          Data Retention
        </h3>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Auto-Delete Old Entries</div>
            <div class="setting-description">Automatically delete journal entries older than specified period</div>
          </div>
          <div class="setting-control">
            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
          </div>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Retention Period</div>
            <div class="setting-description">How long to keep your wellness data</div>
          </div>
          <div class="setting-control">
            <select class="form-control form-control-sm form-select">
              <option value="365" selected>1 Year</option>
              <option value="730">2 Years</option>
              <option value="1095">3 Years</option>
              <option value="0">Keep Forever</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Danger Zone -->
      <div class="setting-group">
        <h3 class="group-title">
          <i class="material-icons">warning</i>
          Danger Zone
        </h3>
        <div class="alert alert-warning">
          <i class="material-icons">warning</i>
          <span>These actions are permanent and cannot be undone.</span>
        </div>

        <div class="setting-item">
          <div class="setting-info">
            <div class="setting-label">Delete All Journal Entries</div>
            <div class="setting-description">Permanently delete all your journal entries and wellness data</div>
          </div>
          <div class="setting-control">
            <button class="btn btn-danger" onclick="confirmDeleteData()">
              <i class="material-icons">delete_forever</i>
              Delete All Data
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Save Actions -->
  <div class="settings-actions">
    <button class="btn btn-secondary" onclick="resetSettings()">
      <i class="material-icons">refresh</i>
      Reset to Defaults
    </button>
    <button class="btn btn-primary" onclick="saveSettings()">
      <i class="material-icons">save</i>
      Save Changes
    </button>
  </div>

  <!-- Success Alert (initially hidden) -->
  <div class="alert alert-success" id="successAlert" style="display: none;">
    <i class="material-icons">check_circle</i>
    <span>Your settings have been saved successfully!</span>
  </div>
</div>
{% endblock content %}

{% block extra_scripts %}
<script>
$(document).ready(function() {
  // Category card selection
  $('.category-card').click(function() {
    $(this).toggleClass('active');
  });
});

function showSection(sectionName) {
  // Update nav tabs
  $('.nav-tab').removeClass('active');
  event.target.closest('.nav-tab').classList.add('active');

  // Show/hide sections
  $('.settings-section').removeClass('active');
  $('#' + sectionName).addClass('active');
}

function toggleSetting(element) {
  // Skip if disabled
  if ($(element).hasClass('disabled')) return;

  $(element).toggleClass('active');
}

function saveSettings() {
  // Collect all settings data
  const settings = {
    categories: $('.category-card.active').map(function() {
      return $(this).data('category');
    }).get(),
    contentLength: $('#contentLength').val(),
    dailyTipsEnabled: $('.setting-item:has(.setting-label:contains("Daily Wellness Tips")) .toggle-switch').hasClass('active'),
    contextualEnabled: $('.setting-item:has(.setting-label:contains("Contextual Content")) .toggle-switch').hasClass('active'),
    // Add more settings as needed
  };

  // TODO: Send settings to backend API
  console.log('Saving settings:', settings);

  // Show success message
  $('#successAlert').show();
  setTimeout(() => {
    $('#successAlert').hide();
  }, 3000);

  // Scroll to top
  $('html, body').animate({ scrollTop: 0 }, 500);
}

function resetSettings() {
  if (confirm('Are you sure you want to reset all settings to default values?')) {
    // Reset all toggle switches
    $('.toggle-switch').removeClass('active');
    // Reset default active toggles
    $('.setting-item:has(.setting-label:contains("Daily Wellness Tips")) .toggle-switch').addClass('active');
    $('.setting-item:has(.setting-label:contains("Contextual Content")) .toggle-switch').addClass('active');
    $('.setting-item:has(.setting-label:contains("Wellness Analytics")) .toggle-switch').addClass('active');

    // Reset category selection
    $('.category-card').removeClass('active');
    $('.category-card[data-category="mental_health"]').addClass('active');
    $('.category-card[data-category="stress_management"]').addClass('active');
    $('.category-card[data-category="mindfulness"]').addClass('active');

    // Reset form fields
    $('#contentLength').val('short_read');

    alert('Settings have been reset to default values.');
  }
}

function exportData(dataType) {
  // TODO: Implement data export functionality
  console.log('Exporting data type:', dataType);
  alert('Data export will begin shortly. You will receive a download link when ready.');
}

function confirmDeleteData() {
  const confirmation = prompt('This will permanently delete ALL your wellness data. Type "DELETE" to confirm:');
  if (confirmation === 'DELETE') {
    if (confirm('Are you absolutely sure? This action cannot be undone.')) {
      // TODO: Implement data deletion
      console.log('Deleting all user wellness data');
      alert('Data deletion initiated. You will receive confirmation when complete.');
    }
  }
}
</script>
{% endblock extra_scripts %}