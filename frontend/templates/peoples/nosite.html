{% extends "peoples/auth_base.html" %}
{% load static %}

{% block title %}Select Site · IntelliWiz{% endblock %}

{% block extra_head %}
    {{ block.super }}
    {{ nositeform.media.css }}
{% endblock %}

{% block extra_scripts %}
    {{ block.super }}
    {{ nositeform.media.js }}
{% endblock %}

{% block brand %}
    <img
        src="{{ static('assets/media/logos/youtility_technologies_logo.svg') }}"
        alt="{{ company_name }}"
        class="auth-logo"
        width="184"
        height="184"
        loading="lazy"
    >
    <h1 class="auth-product">{{ product_name }}</h1>
    <p class="auth-tagline">by {{ company_name }}</p>
    <div class="auth-domain-pill" aria-label="Current environment">{{ env_hostname }}</div>
{% endblock %}

{% block content %}
    <div>
        <h2 class="auth-heading">Select your site</h2>
        <p class="auth-subheading">Choose the location you wish to access for this session.</p>
    </div>

    {% if messages %}
        {% for msg in messages %}
            {% if 'alert-danger' in msg.tags %}
                <div class="auth-alert auth-alert-error" role="alert">{{ msg }}</div>
            {% else %}
                <div class="auth-banner auth-banner-info" role="status">{{ msg }}</div>
            {% endif %}
        {% endfor %}
    {% endif %}

    <form method="post" class="auth-form" id="nosite" data-auth-form novalidate>
        {% csrf_token %}
        {% for field in nositeform.visible_fields %}
            <div class="auth-field">
                {{ field.label_tag(attrs={'class': 'auth-label'}) }}
                <div class="auth-input-wrapper">
                    {{ field.as_widget(attrs={'class': 'auth-select auth-input'}) }}
                </div>
                {% for error in field.errors %}
                    <p class="auth-field-error" role="alert">{{ error }}</p>
                {% endfor %}
            </div>
        {% endfor %}

        <div class="auth-actions">
            <div class="auth-action-row">
                <button type="submit" class="auth-button" data-auth-submit>
                    <span class="auth-button__spinner" aria-hidden="true"></span>
                    <span class="auth-button__label" data-default-label="Continue" data-loading-label="Submitting…">Continue</span>
                </button>
                <a href="{% url 'logout' %}" class="auth-link-button">Log out</a>
            </div>
            <p class="auth-note">You have no default site assigned to your account. Select an available site to proceed or contact <a href="mailto:{{ support_contact }}">{{ support_contact }}</a> for assistance.</p>
        </div>
    </form>
{% endblock %}
